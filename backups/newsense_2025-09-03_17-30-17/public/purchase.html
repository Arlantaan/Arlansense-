<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Order Perfume - Sensation by Sanu</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>
<body>

  <div class="container py-5">
    <h2 class="text-center mb-4">Complete Your Order</h2>
    <div class="row justify-content-center">
      <div class="col-md-6">
        <form id="orderForm">
          <div class="mb-3">
            <label for="product" class="form-label">Perfume</label>
            <input type="text" id="product" name="product" class="form-control" readonly />
          </div>
          <div class="mb-3">
            <label for="name" class="form-label">Full Name</label>
            <input type="text" id="name" name="name" class="form-control" placeholder="Enter your full name" required />
          </div>
          <div class="mb-3">
            <label for="phone" class="form-label">Phone Number</label>
            <input type="tel" id="phone" name="phone" class="form-control" placeholder="WhatsApp number" required />
          </div>
          <div class="mb-3">
            <label for="address" class="form-label">Delivery Address</label>
            <textarea id="address" name="address" class="form-control" rows="3" required></textarea>
          </div>
          <div class="mb-3">
            <label for="payment" class="form-label">Payment Method</label>
            <select id="payment" name="payment" class="form-select" required>
              <option value="">Choose...</option>
              <option value="cash">Cash on Delivery</option>
              <option value="wave">Wave Mobile Money</option>
              <option value="qmoney">QMoney</option>
            </select>
          </div>
          <button type="submit" class="btn btn-success w-100">Place Order</button>
        </form>

        <div id="confirmation" class="alert alert-success mt-4 d-none">
          Thank you! Your order has been placed. We will contact you shortly.
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase v9 SDK -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
    import { getFirestore, collection, addDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Autofill product name from URL
    const urlParams = new URLSearchParams(window.location.search);
    const product = urlParams.get('product') || 'Unknown Perfume';
    document.getElementById('product').value = decodeURIComponent(product);

    // Handle order submission
    document.getElementById('orderForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const orderData = {
        product: document.getElementById('product').value,
        name: document.getElementById('name').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        address: document.getElementById('address').value.trim(),
        payment: document.getElementById('payment').value,
        createdAt: serverTimestamp()
      };

      try {
        await addDoc(collection(db, 'orders'), orderData);

        // Reset form and show confirmation
        e.target.reset();
        document.getElementById('product').value = decodeURIComponent(product); // refill product field
        document.getElementById('confirmation').classList.remove('d-none');
      } catch (error) {
        alert('Error placing order. Please try again.');
        console.error('Firestore error:', error);
      }
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

